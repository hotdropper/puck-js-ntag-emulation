function f(c){for(var a=c.data.length,b=new Uint8Array(a+7>>3),d=0;d<a;d+=8)b[d>>3]=parseInt(c.data.substr(d,8),2);a=new Uint8Array(b.buffer,0,b.length-1);a.reduce(function(a,b){return a^b},0)==b[b.length-1]&&c.callback(a)}function l(c,a){var b=0|1E4*(a.time-a.lastTime);1>b|4<b?(20<c.data.length&&f(c),c.data=""):a.state||(c.data+=0|2<b)}exports.rx=function(c,a){var b={data:"",callback:a,stop:function(){clearWatch(b.intr)}};setTimeout(function(){b.intr=setWatch(l.bind(null,b),c,{repeat:!0,
edge:"both"})},200);return b};exports.tx=function(c,a,b,d){function h(){digitalPulse(c,1,e);0<b--?setTimeout(h,k+2+10*Math.random()):d&&setTimeout(d,k)}var e=[],g=E.toUint8Array(a),f=g.reduce(function(a,b){return a^b},0);a=new Uint8Array(g.length+1);a.set(g);a[a.length-1]=f;a.forEach(function(a){for(var b=7;0<=b;b--)e.push(a&128?.3:.1,.42),a<<=1});e.push(1);var k=E.sum(e)+1;digitalPulse(c,1,[1]);setTimeout(h,1.5)}