function l(a){switch(a){case 0:return g.IDLE;case 1:return g.S1;case 2:return g.S10;case 3:return g.S60;case 4:return g.S025;default:throw"Invalid mode!"+a;}}function k(a,b){return function(d,e){a.write(0);var c=b(d,e);a.write(1);return c}}function f(a,b,d){this.r=d&&d.nWake?k(d.nWake,a):a;this.w=d&&d.nWake?k(d.nWake,b):b;this.options=d||{};this.options.mode=this.options.mode||1;this.w(c.SW_R,[17,229,114,138]);var e=this;setTimeout(function(){if(e.r(c.WHOI,1)[0]!=h.WHIV)throw"CCS811 WHO_AM_I check failed";
e.w(h.BLAS,[]);setTimeout(function(){if(!e.r(c.STAT,1)[0]&h.SFM)throw"CCS811 not in FW mode";e.setMode(e.options.mode)},100)},100)}var h={WHIV:129,SDRD:8,SFM:128,MMID:8,BLAS:244},g={IDLE:0,S1:16,S10:32,S60:48,S025:64},c={STAT:0,MEMO:1,ARD:2,ENVD:5,BASE:17,WHOI:32,SW_R:255};f.prototype._setupWatch=function(){var a=this;a.options["int"]&&!a.watch&&(a.watch=setWatch(function(){a.emit("data",a.get())},a.options["int"],{edge:"falling",repeat:!0}))};f.prototype.stop=function(){this.options.mode=0;this.watch&&
(this.watch=clearWatch(this.watch));this.w(c.MEMO,g.IDLE)};f.prototype.available=function(){return 0!=(this.r(c.STAT,1)[0]&h.SDRD)};f.prototype.setMode=function(a){if(0==a)this.stop();else{var b=l(a);this.options.mode=a;this.options["int"]?(this._setupWatch(),this.w(c.MEMO,b|h.MMID)):this.w(c.MEMO,b)}};f.prototype.readBaseline=function(){return this.r(c.BASE,2)};f.prototype.writeBaseline=function(a){this.w(c.BASE,a)};f.prototype.setEnvData=function(a,b){if(isNaN(a))throw"CCS811 RH NaN!";if(isNaN(b))throw"CCS811 Temp NaN!";
if(!(0<=a&&100>=a))throw"CCS811 RH invalid!";var d=512*a,e=512*(Math.max(-25,b)+25);this.w(c.ENVD,[d>>8,d&255,e>>8,e&255])};f.prototype.get=function(){var a=this.r(c.ARD,5);return{eCO2:a[0]<<8|a[1],TVOC:a[2]<<8|a[3],"new":0!=(a[4]&h.SDRD)}};exports.connectI2C=function(a,b){var d=b&&b.addr||90;return new f(function(b,c){a.writeTo(d,b);return a.readFrom(d,c)},function(b,c){a.writeTo(d,b,c)},b)}