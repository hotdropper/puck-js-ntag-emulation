function b(a,b){this.spi=a;this.cs=b}b.prototype.r=function(a){return this.spi.send([a|128,0],this.cs)[1]};b.prototype.ra=function(a,b){var c=new Uint8Array(b+1);c.fill(a|128);c[b]=0;return this.spi.send(c,this.cs).slice(1)};b.prototype.w=function(a,b){this.spi.write(a,b,this.cs)};b.prototype.antenna=function(a){a?this.w(40,this.r(40)|3):this.w(40,this.r(40)&-4)};b.prototype.init=function(){this.w(84,141);this.w(86,62);this.w(90,30);this.w(88,0);this.w(42,64);this.w(84,61);this.antenna(1)};
b.prototype.req=function(a){this.w(2,0);this.w(4,247);this.w(8,127);this.w(20,128);this.w(18,a);this.w(2,12);this.w(26,this.r(26)|128);this.w(26,this.r(26)&-129);if(a=this.r(12))throw Error("MFRC522 Request Error "+a);a=this.r(20);return this.ra(18,a)};b.prototype.isNewCard=function(){this.w(26,7);return 0<this.req(38).length};b.prototype.getCardSerial=function(){this.w(26,0);var a=this.req([147,32]);return 5==a.length?a.slice(0,-1):[]};b.prototype.findCards=function(a){this.isNewCard()&&a(this.getCardSerial())};
exports.connect=function(a,d){var c=new b(a,d);c.init();return c}