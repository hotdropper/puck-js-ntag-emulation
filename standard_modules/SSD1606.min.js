function b(a){if("GDE021A1"===a.displayType)this.display=d.GDE021A1;else if(a.display)this.display=a.display;else return Error('Unknown display type "'+a.displayType+'"" and no display configuration provided!');this.spi=a.spi;this.bs1Pin=a.bs1Pin;this.cs1Pin=a.cs1Pin;this.dcPin=a.dcPin;this.busyPin=a.busyPin;this.resetPin=a.resetPin;this.powerPin=a.powerPin;this.g=this.grfx();this.csbTimeOut=a.clearScreenTimeOut?a.clearScreenTimeOut:100;this.hwResetTimeOut=a.clearScreenTimeOut?a.hardwareResetTimeOut:
100}var d={GDE021A1:{bpp:2,displaySizeX:72,displaySizeY:172,lutRegisterData:new Uint8Array([0,0,0,85,0,0,85,85,0,85,85,85,170,170,170,170,21,21,21,21,5,5,5,5,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,251,34,27,0,0,0,0,0,0]),maxScreenBytes:3096,ramXStartAddress:0,ramXEndAddress:17,ramYStartAddress:0,ramYEndAddress:171}};b.prototype.reset=function(){this.scd(1,179);this.scd(3,234);this.scd(4,10);this.scd(58,4);this.scd(59,8);this.scd(44,
160);this.scd(60,115);this.scd(17,3);this.scd(78,0);this.scd(79,0);this.scd(240,31)};b.prototype.on=function(){this.powerPin&&digitalWrite(this.powerPin,HIGH)};b.prototype.off=function(){this.powerPin&&digitalWrite(this.powerPin,LOW)};b.prototype.hwReset=function(a){digitalWrite(this.resetPin,LOW);digitalWrite(this.resetPin,HIGH);return setTimeout(a,this.hwResetTimeOut)};b.prototype.init=function(a,b){this.bs1Pin&&digitalWrite(this.bs1Pin,LOW);this.scd(16,0);this.scd(17,3);this.scd(68,[this.display.ramXStartAddress,
this.display.ramXEndAddress]);this.scd(69,[this.display.ramYStartAddress,this.display.ramYEndAddress]);this.scd(78,0);this.scd(79,0);this.scd(240,31);this.scd(34,192);this.scd(50,this.display.lutRegisterData);this.scd(44,160);this.scd(60,99);this.scd(34,196);return b&&b.clearScreenColor?this.csb(a,b.clearScreenColor):a()};b.prototype.sc=function(a){digitalWrite(this.dcPin,LOW);this.spi.write(a,this.cs1Pin)};b.prototype.psd=function(){digitalWrite(this.dcPin,HIGH)};b.prototype.sd=function(a){this.spi.write(a,
this.cs1Pin)};b.prototype.scd=function(a,b){this.sc(a);this.psd();this.sd(b)};b.prototype.cbp=function(a){return setWatch(a,this.busyPin,{repeat:!1,edge:"falling"})};b.prototype.csb=function(a,b){this.scd(68,0);this.scd(69,0);this.sc(36);this.psd();for(var c=0;c<this.display.maxScreenBytes;c++)this.sd(b);this.sc(255);return setTimeout(a,this.csbTimeOut)};b.prototype.refreshScreen=function(a){this.sc(32);this.scd(34,3);this.sc(32);return this.cbp(a)};b.prototype.sxyc=function(a,b){this.scd(78,a);this.scd(79,
b)};b.prototype.grfx=function(){var a=this,b=Graphics.createArrayBuffer(this.display.displaySizeX,this.display.displaySizeY,this.display.bpp,{msb:!0});b.clear=function(a){(new Uint8Array(this.buffer)).fill(a)};b.flip=function(){a.sxyc(0,0);a.scd(36,this.buffer);a.sc(255)};return b};exports.connect=function(a){return new b(a)}