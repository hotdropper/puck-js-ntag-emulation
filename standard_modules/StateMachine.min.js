function e(a,c){var b=this;void 0!==b.pending&&(b.pending=clearTimeout(b.pending));if(c)return b.pending=setTimeout(function(){b.pending=void 0;e.call(b,a)},c);if(a!=b.state&&a in b.states){var d=b.states[b.state];d&&"exit"in d&&d.exit.call(b);b.last.state=b.state;b.state=a;"enter"in b.states[a]&&(d=b.states[a].enter.call(b))&&e.call(b,d.state,d.wait||0)}}function f(a){if("string"==typeof a)return delete this.states[a];if("name"in a)return this.states[a.name]=a}function g(a){var c=this.states[this.state];
c&&"signal"in c&&(this.last.event=a,(a=c.signal.call(this,a))&&e.call(this,a.state,a.wait||0))}exports.FSM=function(){var a={last:{state:"",event:null},state:"",pending:void 0,states:{},define:f,init:function(c){e.call(a,c)},signal:g};return a}