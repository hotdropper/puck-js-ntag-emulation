function c(b,a){"object"!=typeof a&&(a={});this.g=b;this.charW=a.charWidth||4;this.charH=a.charHeight||8;this.y=this.x=0;this.ox=0|a.marginLeft;this.oy=0|a.marginTop;this.consoleHeight=0|(b.getHeight()-(this.oy+(0|a.marginBottom)))/this.charH;this.controlChars=""}c.prototype.drawCursor=function(){this.g.fillRect(this.ox+this.x*this.charW,this.oy+(this.y+1)*this.charH-1,this.ox+(this.x+1)*this.charW-1,this.oy+(this.y+1)*this.charH-1)};c.prototype.scrollDown=function(){if(void 0!==this.g.buffer){var b=
this.g.buffer.length*this.charH/this.g.getHeight();(new Uint8Array(this.g.buffer)).set(new Uint8Array(this.g.buffer,b),0);this.y--}else this.g.clear(),this.y=0};c.prototype["char"]=function(b){var a=b.charCodeAt(0);this.g.setColor(0);this.drawCursor();if(0===this.controlChars.length)if(8==a)0<this.x&&this.x--;else if(10==a)for(this.x=0,this.y++;this.y>=this.consoleHeight;)this.scrollDown();else 13==a?this.x=0:27==a?this.controlChars=[27]:19!=a&&17!=a&&(this.g.fillRect(this.ox+this.x*this.charW,this.oy+
this.y*this.charH,this.ox+(this.x+1)*this.charW-1,this.oy+(this.y+1)*this.charH-1),this.g.setColor(1,1,1),this.g.drawString(b,this.ox+this.x*this.charW,this.oy+this.y*this.charH),this.x++);else if(27==this.controlChars[0])if(91==this.controlChars[1])if(63==this.controlChars[2])55==this.controlChars[3]?(108!=a&&console.log("Expected 27, 91, 63, 55, 108 - no line overflow sequence"),this.controlChars=[]):this.controlChars=55==a?[27,91,63,55]:[];else switch(this.controlChars=[],a){case 63:this.controlChars=
[27,91,63];break;case 65:0<this.y&&this.y--;break;case 66:for(this.y++;this.y>=this.consoleHeight;)this.scroll();break;case 67:this.x++;break;case 68:0<this.x&&this.x--}else switch(a){case 91:this.controlChars=[27,91];break;default:this.controlChars=[]}else this.controlChars=[];this.g.setColor(1,1,1);this.drawCursor()};exports.connect=function(b,a){return new c(b,a)}