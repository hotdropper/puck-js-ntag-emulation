var c={debug:function(){this.at.debug()},reset:function(a){this.serialStarted&&at.cmd("AT+RST\r\n",1E3,function(){return function(b){if(void 0!==b&&"ERROR"==b){if(void 0!==a)return a("Error");if(void 0!==a)return a("Ok")}}})},getMAC:function(a){this.serialStarted&&at.cmd("AT+GETMAC\r\n",1E3,function(){return function(b){if("ERROR"==b)return a("Error");m=b.split("=");return a(m[1])}})},getIP:function(a){this.serialStarted&&at.cmd("AT+GETIP\r\n",1E3,function(){return function(b){if("ERROR"==
b)return a("Error");m=b.split("=");return a(m[1])}})},WiFiConnect:function(a,b,d){this.serialStarted&&(at.unregisterLine("OK"),at.unregisterLine("ERROR"),at.registerLine("OK",function(){at.unregisterLine("OK");at.unregisterLine("ERROR");d&&d("Ok")}),at.registerLine("ERROR",function(){at.unregisterLine("OK");at.unregisterLine("ERROR");d&&d("Error")}),at.write('AT+WIFICONNECT="'+a+'","'+b+'"\r\n'))},setOptions:function(a,b){if(this.serialStarted){at.unregisterLine("OK");at.unregisterLine("ERROR");at.registerLine("OK",
function(){at.unregisterLine("OK");at.unregisterLine("ERROR");b&&b("Ok")});at.registerLine("ERROR",function(){at.unregisterLine("OK");at.unregisterLine("ERROR");b&&b("Error")});at.write("AT+SETOPTIONS=");var d=0,c=Object.keys(a).length;for(o in a)at.write('"'+o+'","'+a[o]+'"'),d++,d<c&&at.write(",");at.write("\r\n")}},update:function(a,b){if(this.serialStarted&&this.connected){at.unregisterLine("OK");at.unregisterLine("ERROR");at.registerLine("OK",function(){at.unregisterLine("OK");at.unregisterLine("ERROR");
b&&b("Ok")});at.registerLine("ERROR",function(){at.unregisterLine("OK");at.unregisterLine("ERROR");b&&b("Error")});at.write("AT+UPDATE=");var d=0,c=Object.keys(a).length;for(o in a)at.write('"'+o+'","'+a[o]+'"'),d++,d<c&&at.write(",");at.write("\r\n")}},expose:function(a,b,d){this.serialStarted&&this.connected&&(at.unregisterLine("OK"),at.unregisterLine("ERROR"),at.registerLine("OK",function(){at.unregisterLine("OK");at.unregisterLine("ERROR");d&&d("Ok")}),at.registerLine("ERROR",function(){at.unregisterLine("OK");
at.unregisterLine("ERROR");d&&d("Error")}),at.write('AT+EXPOSE="'+a+'"\r\n'),void 0!==b&&null!==b&&(c.at.unregisterLine('+THINGDO="'+a+'"'),c.at.registerLine('+THINGDO="'+a+'"',function(a){parameters=a.substring(a.indexOf("+THINGDO=")+9,a.length).split(",");b(parameters);return""})))},connect:function(a,b,d,c){if(this.serialStarted&&!this.connected){at.unregisterLine("OK");at.unregisterLine("ERROR");at.registerLine("OK",function(){at.unregisterLine("OK");at.unregisterLine("ERROR");b&&b("Ok")});at.registerLine("ERROR",
function(){at.unregisterLine("OK");at.unregisterLine("ERROR");b&&b("Error")});void 0!==d&&null!==d&&(this.connectedCallback=d);void 0!==c&&null!==c&&(this.disconnectedCallback=c);at.write("AT+CONNECT");if(null!==a&&void 0!==a)for(o in at.write("="),d=0,c=Object.keys(a).length,a)at.write('"'+o+'","'+a[o]+'"'),d++,d<c&&at.write(",");at.write("\r\n")}},disconnect:function(a,b){this.serialStarted&&this.connected&&(at.cmd("AT+DISCONNECT\r\n",1E3,function(){return function(b){return"ERROR"==b?a("Error"):
a("Ok")}}),void 0!==b&&null!==b&&(this.disconnectedCallback=b))},version:function(a){this.serialStarted&&at.cmd("AT+GMR\r\n",1E3,function(){return function(b){if("ERROR"==b||7!=b.indexOf("Vizibles AT"))return a("Error");m=b.substring(b.indexOf("="),b.indexOf("O"));return a(m)}})}};exports.init=function(a,b){c.at=at=require("AT").connect(a);c.serialStarted=!1;c.connected=!1;c.connectedCallback=null;c.disconnectedCallback=null;c.at.register("+VZ-READY>",function(a){c.serialStarted=!0;b();return""});
c.at.unregisterLine("OK");c.at.unregisterLine("ERROR");c.at.registerLine("+CONNECTED",function(a){c.connected=!0;null!==c.connectedCallback&&c.connectedCallback();return""});c.at.registerLine("+DISCONNECTED",function(a){c.connected=!1;null!==c.disconnectedCallback&&c.disconnectedCallback();return""});return c}