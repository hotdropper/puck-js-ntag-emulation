/* Copyright (c) 2018 Derek Arthur, Durnaford Ltd. Derived from the works of Gordon Williams, Pur3 Ltd. See the file LICENSE for copying permission. */
/* 
Usage:
  var mouse = require("ble_hid_mouse");
  NRF.setServices(undefined, { hid : mouse.report });
  mouse.send(0,0,mouse.BUTTONS.LEFT); // X movement, Y movement, buttons pressed
*/

exports.report = new Uint8Array([
  0x05,   0x01,
  0x09,   0x02,
  0xA1,   0x01,
  0x09,   0x01,

  0xA1,   0x00,
  0x05,   0x09,
  0x19,   0x01,
  0x29,   0x03,

  0x15,   0x00,
  0x25,   0x01,
  0x95,   0x03,
  0x75,   0x01,

  0x81,   0x02,
  0x95,   0x01,
  0x75,   0x05,
  0x81,   0x01,

  0x05,   0x01,
  0x09,   0x30,
  0x09,   0x31,
  0x09,   0x38,

  0x15,   0x81,
  0x25,   0x7F,
  0x75,   0x08,
  0x95,   0x03,

  0x81,   0x06,
  0xC0,   0x09,
  0x3c,   0x05,
  0xff,   0x09,

  0x01,   0x15,
  0x00,   0x25,
  0x01,   0x75,
  0x01,   0x95,

  0x02,   0xb1,
  0x22,   0x75,
  0x06,   0x95,
  0x01,   0xb1,

  0x01,   0xc0 ]
);

exports.BUTTONS = {
  NONE : 0,
  LEFT : 1,
  RIGHT : 2,
  MIDDLE : 4
};
exports.send = function(x,y,b, callback) {
  NRF.sendHIDReport([b,x,y,0,0,0,0,0], function() {
    NRF.sendHIDReport([0,0,0,0,0,0,0,0], function() {
      if (callback) callback();
    });    
  });
};
