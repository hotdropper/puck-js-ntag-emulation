exports.connect=function(l){var f,e,h,k,d,g={write:function(a){return new Promise(function b(d,c){a.length?(k.writeValue(a.substr(0,20)).then(function(){b(d,c)})["catch"](c),a=a.substr(20)):d()})},disconnect:function(){return f.disconnect()},eval:function(a){return new Promise(function(m,f){function c(){var a=b.indexOf("\n");if(0<=a){clearTimeout(e);d=e=void 0;var c=b.substr(0,a);try{m(JSON.parse(c))}catch(n){f(c)}b.length>a+1&&g.emit("data",b.substr(a+1))}}var b="";var e=setTimeout(c,
5E3);d=function(a){b+=a;0<=b.indexOf("\n")&&c()};g.write("\u0003\u0010Bluetooth.write(JSON.stringify("+a+")+'\\n')\n").then(function(){})})}};return l.gatt.connect().then(function(a){f=a;return f.getPrimaryService("6e400001-b5a3-f393-e0a9-e50e24dcca9e")}).then(function(a){e=a;return e.getCharacteristic("6e400002-b5a3-f393-e0a9-e50e24dcca9e")}).then(function(a){k=a;return e.getCharacteristic("6e400003-b5a3-f393-e0a9-e50e24dcca9e")}).then(function(a){h=a;h.on("characteristicvaluechanged",function(a){a=
E.toString(a.target.value.buffer);d?d(a):g.emit("data",a)});return h.startNotifications()}).then(function(){return g})}