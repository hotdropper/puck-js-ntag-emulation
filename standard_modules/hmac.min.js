function e(b,d,a){null==a&&(a=hashlib.sha256);this.finished=!1;this.inner=a();this.outer=a();var c=new Uint8Array(this.inner.block_size);b.length>this.inner.block_size&&(b=(new a).update(k),b=E.toBufferArray(b.digest()));for(a=0;a<b.length;a++)c[a]=b[a].charCodeAt(0);for(a=0;a<c.length;a++)c[a]^=54;this.inner.update(String.fromCharCode.apply(null,c));for(a=0;a<c.length;a++)c[a]^=106;this.outer.update(String.fromCharCode.apply(null,c));for(a=0;a<c.length;a++)c[a]=0;d&&this.inner.update(d)}
e.prototype.update=function(b){b&&(this.finished=!1,this.inner.update(b));return this};e.prototype.digest=function(){this.finished||(this.outer.update(this.inner.digest()),this.finished=!0);return this.outer.digest()};e.prototype.hexdigest=function(){var b,d="",a=this.digest();for(b=0;b<a.length;b++)d+=(256+a.charCodeAt(b)).toString(16).substr(-2);return d};exports.create=function(b,d,a){return new e(b,d,a)};exports.compare_digest=function(b,d){var a,c;if(b.length!=d.length)return!1;for(c=a=0;c<b.length;c++)a|=
b.charCodeAt(c)^d.charCodeAt(c);return 0==a}